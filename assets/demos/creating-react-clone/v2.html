<!DOCTYPE html>
<html>
    <body>
        <div id="root"></div>

        <script>
            const eventsMap = {
                onSubmit: "submit",
                onClick: "click",
                // and so on ...
            };
            const root = document.getElementById("root");
            const app = render(App());
            root.appendChild(app);

            function App() {
                function onSubmit(e) {
                    e.preventDefault();
                    const inputEl = e.target.querySelector(".input-todo");
                    console.log(inputEl.value);
                }
                return {
                    name: "div",
                    className: "app",
                    id: "app",
                    children: [
                        Header(),
                        TodoForm({ onSubmit })
                    ]
                }
            }

            function Header(props){
                return {
                    name: "h1",
                    style: {
                        "text-align": "center"
                    },
                    children: ["Todo List"]
                };
            }

            function TodoForm(props) {
                const inputEl = {
                    name: "input",
                    type: "text",
                    placeholder: "Add a new todo",
                    className: "input-todo",
                    style: {
                        padding: "6px 12px",
                        display: "block",
                        width: "100%",
                        "box-sizing": "border-box"
                    }
                };
                return {
                    name: "form",
                    style: {
                        width: "50%",
                        margin: "auto"
                    },
                    onSubmit: props.onSubmit,
                    children: [inputEl]
                };
            }

            function render(component) {
                // We collect all other attributes in `otherAttributes`
                const {name, style, children, ...otherAttributes} = component;

                const el = document.createElement(name);

                // Add all styles to the element
                if (typeof style === "object") {
                    for (const styleName in style) {
                        el.style[styleName] = style[styleName];
                    }
                }

                // Add all attributes to the element
                // An attribute can be a simple string or an event handler
                // If it is an event handler, it needs to be DOM supported so we'll check it
                // against our list of possible events
                for(let key in otherAttributes) {
                    const value = otherAttributes[key];
                    if (typeof value === "string") {
                        // class is a reserved keyword so we'll instead use "className" in our
                        // components and convert it back to "class" here before setting it.
                        if (key === "className") {
                            key = "class";
                        }
                        el.setAttribute(key, value);
                        continue;
                    }
                    if (typeof value === "function" && eventsMap[key]) {
                        el.addEventListener(eventsMap[key], value);
                    }
                }

                // If there are children, iterate through them and append them in `el`
                if (Array.isArray(children)) {
                    for(let i = 0, l = children.length; i < l; i++) {
                        const child = children[i];
    
                        // it's text, create a text node
                        if (typeof child === "string") {
                            const textNode = document.createTextNode(child);
                            el.appendChild(textNode);
                            continue;
                        }
    
                        // It's a component; we need to call render again
                        if (typeof child === "object") {
                            el.appendChild(render(child));
                        }
                    }
                }

                return el;
            }


        </script>
    </body>
</html>
